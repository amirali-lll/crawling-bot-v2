# راهنمای شروع سریع

ربات خزنده خود را در چند دقیقه راه‌اندازی کنید!

## پیش‌نیازها

- برد ESP32-S3-DevKitM-1
- نمایشگر OLED 0.96" (SSD1306، I2C)
- سنسور AHRS مدل MPU9250 (I2C)
- ۲ موتور سروو
- PlatformIO نصب‌شده

## راه‌اندازی سخت‌افزار

### سیم‌کشی

**اتصالات I2C (OLED و MPU9250):**

- SDA → GPIO 21 (پین SDA پیش‌فرض ESP32)
- SCL → GPIO 22 (پین SCL پیش‌فرض ESP32)
- VCC → 3.3V
- GND → GND

**سروها:**

- Servo Down → GPIO 32
- Servo Up → GPIO 33
- VCC → 5V (منبع تغذیه خارجی توصیه می‌شود)
- GND → GND

**برق:**

- ESP32-S3 از طریق USB-C
- سروها از طریق منبع تغذیه خارجی ۵ ولت (برای عملکرد پایدار توصیه می‌شود)

### آدرس‌های I2C

- نمایشگر OLED: 0x3C
- MPU9250: 0x68

## راه‌اندازی نرم‌افزار

### ۱. کلون و باز کردن پروژه

```bash
git clone https://github.com/amirali-lll/crawling-bot-v2.git
cd crawling-bot-v2
```

در VS Code با افزونه PlatformIO باز کنید یا از خط فرمان استفاده کنید.

### ۲. ساخت

```bash
pio run
```

### ۳. آپلود

ESP32-S3 را از طریق USB وصل کنید و آپلود کنید:

```bash
pio run --target upload
```

### ۴. مانیتور

```bash
pio device monitor -b 115200
```

### ۵. تنظیم شماره ربات

در اولین بوت، ربات از شما یک شماره (۱-۸) می‌خواهد:

1. مانیتور سریال را باز کنید (115200 baud)
2. عددی بین ۱ تا ۸ وارد کنید
3. Enter بزنید

شماره در EEPROM ذخیره می‌شود و برای نام WiFi AP استفاده می‌شود.

## اجرای اول

پس از آپلود، ربات:

1. **نمایشگر را مقداردهی می‌کند** - "RL Robot V2" را نشان می‌دهد
2. **شبکه را راه‌اندازی می‌کند** - WiFi AP ایجاد می‌کند (ESP32-AP-{number})
3. **AHRS را مقداردهی می‌کند** - MPU9250 را کالیبره می‌کند
4. **سروها را مقداردهی می‌کند** - به موقعیت اولیه می‌رود
5. **بررسی سلامت** - تمام اجزا را تست می‌کند
6. **حلقه اصلی** - وضعیت و داده‌های سنسور را نمایش می‌دهد

نمایشگر OLED را برای پیام‌های وضعیت تماشا کنید!

## نقطه دسترسی WiFi

ربات یک WiFi AP ایجاد می‌کند:

- **SSID:** `ESP32-AP-{robot_number}`
- **رمز عبور:** `12345678`
- **IP:** `192.168.4.1`

## به‌روزرسانی‌های OTA (پس از اولین آپلود)

1. به WiFi AP ربات متصل شوید
2. از طریق OTA آپلود کنید:
   ```bash
   pio run --target upload --upload-port ESP32-OTA-{number}.local
   ```

## تأیید درستی کار همه چیز

### روی نمایشگر OLED

باید این را ببینید:

```
RL Robot V2
Initializing...

Robot #X
Setup...

Init AHRS...
AHRS OK

Init Servos...
Servos OK

Health Check
...

Robot #X
Running...
Y:123 T:25C
```

### روی مانیتور سریال (115200 baud)

```
AP Started
AP SSID: ESP32-AP-1
IP Address: 192.168.4.1
OTA Ready
OTA Hostname: ESP32-OTA-1
MPU9250 initialized successfully
Training module initialized (empty - to be implemented)
```

### رفتار فیزیکی

در حین بررسی سلامت:

1. نمایشگر "Health Check" را نشان می‌دهد
2. سروها به ۹۰ درجه می‌روند (موقعیت تست)
3. سروها به موقعیت اولیه برمی‌گردند (down=0°، up=180°)
4. نمایشگر داده‌های جهت‌گیری را نشان می‌دهد

## عیب‌یابی

### نمایشگر کار نمی‌کند

- سیم‌کشی I2C (SDA/SCL) را بررسی کنید
- تأیید کنید آدرس نمایشگر 0x3C است
- `i2cdetect` را برای اسکن باس I2C امتحان کنید

### AHRS ناموفق بود

- سیم‌کشی MPU9250 را بررسی کنید
- تأیید کنید آدرس سنسور 0x68 است
- مطمئن شوید سنسور برق دارد (3.3V)

### سروها حرکت نمی‌کنند

- منبع تغذیه را بررسی کنید (۵V، جریان کافی)
- اتصالات GPIO را تأیید کنید (32، 33)
- سیم‌های سیگنال سروو را بررسی کنید

### نمی‌توانم آپلود کنم

- درایورهای USB CH340 یا CP2102 را نصب کنید
- کابل USB را بررسی کنید (باید از داده پشتیبانی کند)
- تأیید کنید برد در حالت bootloader است
- در حین آپلود دکمه BOOT را فشار دهید

### شماره ربات ذخیره نمی‌شود

- ممکن است مقداردهی EEPROM ناموفق باشد
- فریمور را دوباره آپلود کنید
- مانیتور سریال را برای خطاها بررسی کنید

## مراحل بعدی

حالا که ربات شما اجرا می‌شود:

1. **AHRS را تست کنید** - ربات را حرکت دهید و تغییر جهت‌گیری را ببینید
2. **سروها را تست کنید** - کد را تغییر دهید تا موقعیت‌های مختلف را امتحان کنید
3. **MPU9250 را کالیبره کنید** - برای دقت بهتر (BUILD.fa.md را ببینید)
4. **آموزش را پیاده‌سازی کنید** - الگوریتم RL خود را به کتابخانه Training اضافه کنید
5. **رفتار را سفارشی کنید** - حلقه اصلی را برای کاربرد خود تغییر دهید

## به کمک نیاز دارید؟

این فایل‌ها را بررسی کنید:

- `README.fa.md` - مستندات کامل پروژه
- `BUILD.fa.md` - دستورالعمل‌های دقیق ساخت
- `MIGRATION.fa.md` - مهاجرت از کد قدیمی
- `EXAMPLES.fa.md` - نمونه کدها
- `lib/*/` - کد منبع کتابخانه‌ها

## نکات ایمنی

⚠️ **مهم:**

- هنگام کار با سروها احتیاط کنید
- از منبع تغذیه مناسب با جریان کافی استفاده کنید
- اتصالات را قبل از روشن کردن بررسی کنید
- از اتصال کوتاه سیم‌ها جلوگیری کنید
